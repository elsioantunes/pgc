instance Show a => Show (Arv a) where
    show m = "\n\n" ++ (unlines $ go  m) ++ "\n\n"
      where
        go (No a ns) =  lines ("[" ++ show a ++ "]") ++ subtree ns
        subtree [] = []
        subtree (n:ns) = " |" : " |" : (zipWith (++) (" +--." : repeat " |  ") (go n)) ++ subtree ns

----------------------------------------------------------------------    
data Arv a = No a [Arv a]
type Split = (Int, [Int])

splits :: [Int] -> [Split]
splits [] = []
splits (x:xs) = (x, xs) : [(a,x:b) | (a, b) <- splits xs]

perms :: [Int] -> [Arv (Maybe Int)]
perms [] = []
perms m = map f $ splits m where
    f (n, ns) = No (Just n) $ map f $ splits ns


{--

*Main> perms [1..5]


[

    [Just 1]
     |
     |
     +--.[Just 2]
     |   |
     |   |
     |   +--.[Just 3]
     |   |   |
     |   |   |
     |   |   +--.[Just 4]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 5]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 4]
     |   |
     |   |
     |   +--.[Just 4]
     |   |   |
     |   |   |
     |   |   +--.[Just 3]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 5]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 3]
     |   |
     |   |
     |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 3]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 4]
     |   |   |
     |   |   |
     |   |   +--.[Just 4]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 3]
     |
     |
     +--.[Just 3]
     |   |
     |   |
     |   +--.[Just 2]
     |   |   |
     |   |   |
     |   |   +--.[Just 4]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 5]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 4]
     |   |
     |   |
     |   +--.[Just 4]
     |   |   |
     |   |   |
     |   |   +--.[Just 2]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 5]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 2]
     |   |
     |   |
     |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 2]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 4]
     |   |   |
     |   |   |
     |   |   +--.[Just 4]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 2]
     |
     |
     +--.[Just 4]
     |   |
     |   |
     |   +--.[Just 2]
     |   |   |
     |   |   |
     |   |   +--.[Just 3]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 5]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 3]
     |   |
     |   |
     |   +--.[Just 3]
     |   |   |
     |   |   |
     |   |   +--.[Just 2]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 5]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 2]
     |   |
     |   |
     |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 2]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 3]
     |   |   |
     |   |   |
     |   |   +--.[Just 3]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 2]
     |
     |
     +--.[Just 5]
     |   |
     |   |
     |   +--.[Just 2]
     |   |   |
     |   |   |
     |   |   +--.[Just 3]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 4]
     |   |   |
     |   |   |
     |   |   +--.[Just 4]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 3]
     |   |
     |   |
     |   +--.[Just 3]
     |   |   |
     |   |   |
     |   |   +--.[Just 2]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 4]
     |   |   |
     |   |   |
     |   |   +--.[Just 4]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 2]
     |   |
     |   |
     |   +--.[Just 4]
     |   |   |
     |   |   |
     |   |   +--.[Just 2]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 3]
     |   |   |
     |   |   |
     |   |   +--.[Just 3]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 2]


,

    [Just 2]
     |
     |
     +--.[Just 1]
     |   |
     |   |
     |   +--.[Just 3]
     |   |   |
     |   |   |
     |   |   +--.[Just 4]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 5]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 4]
     |   |
     |   |
     |   +--.[Just 4]
     |   |   |
     |   |   |
     |   |   +--.[Just 3]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 5]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 3]
     |   |
     |   |
     |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 3]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 4]
     |   |   |
     |   |   |
     |   |   +--.[Just 4]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 3]
     |
     |
     +--.[Just 3]
     |   |
     |   |
     |   +--.[Just 1]
     |   |   |
     |   |   |
     |   |   +--.[Just 4]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 5]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 4]
     |   |
     |   |
     |   +--.[Just 4]
     |   |   |
     |   |   |
     |   |   +--.[Just 1]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 5]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 1]
     |   |
     |   |
     |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 1]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 4]
     |   |   |
     |   |   |
     |   |   +--.[Just 4]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 1]
     |
     |
     +--.[Just 4]
     |   |
     |   |
     |   +--.[Just 1]
     |   |   |
     |   |   |
     |   |   +--.[Just 3]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 5]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 3]
     |   |
     |   |
     |   +--.[Just 3]
     |   |   |
     |   |   |
     |   |   +--.[Just 1]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 5]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 1]
     |   |
     |   |
     |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 1]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 3]
     |   |   |
     |   |   |
     |   |   +--.[Just 3]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 1]
     |
     |
     +--.[Just 5]
     |   |
     |   |
     |   +--.[Just 1]
     |   |   |
     |   |   |
     |   |   +--.[Just 3]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 4]
     |   |   |
     |   |   |
     |   |   +--.[Just 4]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 3]
     |   |
     |   |
     |   +--.[Just 3]
     |   |   |
     |   |   |
     |   |   +--.[Just 1]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 4]
     |   |   |
     |   |   |
     |   |   +--.[Just 4]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 1]
     |   |
     |   |
     |   +--.[Just 4]
     |   |   |
     |   |   |
     |   |   +--.[Just 1]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 3]
     |   |   |
     |   |   |
     |   |   +--.[Just 3]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 1]


,

    [Just 3]
     |
     |
     +--.[Just 1]
     |   |
     |   |
     |   +--.[Just 2]
     |   |   |
     |   |   |
     |   |   +--.[Just 4]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 5]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 4]
     |   |
     |   |
     |   +--.[Just 4]
     |   |   |
     |   |   |
     |   |   +--.[Just 2]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 5]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 2]
     |   |
     |   |
     |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 2]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 4]
     |   |   |
     |   |   |
     |   |   +--.[Just 4]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 2]
     |
     |
     +--.[Just 2]
     |   |
     |   |
     |   +--.[Just 1]
     |   |   |
     |   |   |
     |   |   +--.[Just 4]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 5]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 4]
     |   |
     |   |
     |   +--.[Just 4]
     |   |   |
     |   |   |
     |   |   +--.[Just 1]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 5]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 1]
     |   |
     |   |
     |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 1]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 4]
     |   |   |
     |   |   |
     |   |   +--.[Just 4]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 1]
     |
     |
     +--.[Just 4]
     |   |
     |   |
     |   +--.[Just 1]
     |   |   |
     |   |   |
     |   |   +--.[Just 2]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 5]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 2]
     |   |
     |   |
     |   +--.[Just 2]
     |   |   |
     |   |   |
     |   |   +--.[Just 1]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 5]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 1]
     |   |
     |   |
     |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 1]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 2]
     |   |   |
     |   |   |
     |   |   +--.[Just 2]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 1]
     |
     |
     +--.[Just 5]
     |   |
     |   |
     |   +--.[Just 1]
     |   |   |
     |   |   |
     |   |   +--.[Just 2]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 4]
     |   |   |
     |   |   |
     |   |   +--.[Just 4]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 2]
     |   |
     |   |
     |   +--.[Just 2]
     |   |   |
     |   |   |
     |   |   +--.[Just 1]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 4]
     |   |   |
     |   |   |
     |   |   +--.[Just 4]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 1]
     |   |
     |   |
     |   +--.[Just 4]
     |   |   |
     |   |   |
     |   |   +--.[Just 1]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 2]
     |   |   |
     |   |   |
     |   |   +--.[Just 2]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 1]


,

    [Just 4]
     |
     |
     +--.[Just 1]
     |   |
     |   |
     |   +--.[Just 2]
     |   |   |
     |   |   |
     |   |   +--.[Just 3]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 5]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 3]
     |   |
     |   |
     |   +--.[Just 3]
     |   |   |
     |   |   |
     |   |   +--.[Just 2]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 5]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 2]
     |   |
     |   |
     |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 2]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 3]
     |   |   |
     |   |   |
     |   |   +--.[Just 3]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 2]
     |
     |
     +--.[Just 2]
     |   |
     |   |
     |   +--.[Just 1]
     |   |   |
     |   |   |
     |   |   +--.[Just 3]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 5]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 3]
     |   |
     |   |
     |   +--.[Just 3]
     |   |   |
     |   |   |
     |   |   +--.[Just 1]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 5]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 1]
     |   |
     |   |
     |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 1]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 3]
     |   |   |
     |   |   |
     |   |   +--.[Just 3]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 1]
     |
     |
     +--.[Just 3]
     |   |
     |   |
     |   +--.[Just 1]
     |   |   |
     |   |   |
     |   |   +--.[Just 2]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 5]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 2]
     |   |
     |   |
     |   +--.[Just 2]
     |   |   |
     |   |   |
     |   |   +--.[Just 1]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 5]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 1]
     |   |
     |   |
     |   +--.[Just 5]
     |   |   |
     |   |   |
     |   |   +--.[Just 1]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 2]
     |   |   |
     |   |   |
     |   |   +--.[Just 2]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 1]
     |
     |
     +--.[Just 5]
     |   |
     |   |
     |   +--.[Just 1]
     |   |   |
     |   |   |
     |   |   +--.[Just 2]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 3]
     |   |   |
     |   |   |
     |   |   +--.[Just 3]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 2]
     |   |
     |   |
     |   +--.[Just 2]
     |   |   |
     |   |   |
     |   |   +--.[Just 1]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 3]
     |   |   |
     |   |   |
     |   |   +--.[Just 3]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 1]
     |   |
     |   |
     |   +--.[Just 3]
     |   |   |
     |   |   |
     |   |   +--.[Just 1]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 2]
     |   |   |
     |   |   |
     |   |   +--.[Just 2]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 1]


,

    [Just 5]
     |
     |
     +--.[Just 1]
     |   |
     |   |
     |   +--.[Just 2]
     |   |   |
     |   |   |
     |   |   +--.[Just 3]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 4]
     |   |   |
     |   |   |
     |   |   +--.[Just 4]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 3]
     |   |
     |   |
     |   +--.[Just 3]
     |   |   |
     |   |   |
     |   |   +--.[Just 2]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 4]
     |   |   |
     |   |   |
     |   |   +--.[Just 4]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 2]
     |   |
     |   |
     |   +--.[Just 4]
     |   |   |
     |   |   |
     |   |   +--.[Just 2]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 3]
     |   |   |
     |   |   |
     |   |   +--.[Just 3]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 2]
     |
     |
     +--.[Just 2]
     |   |
     |   |
     |   +--.[Just 1]
     |   |   |
     |   |   |
     |   |   +--.[Just 3]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 4]
     |   |   |
     |   |   |
     |   |   +--.[Just 4]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 3]
     |   |
     |   |
     |   +--.[Just 3]
     |   |   |
     |   |   |
     |   |   +--.[Just 1]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 4]
     |   |   |
     |   |   |
     |   |   +--.[Just 4]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 1]
     |   |
     |   |
     |   +--.[Just 4]
     |   |   |
     |   |   |
     |   |   +--.[Just 1]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 3]
     |   |   |
     |   |   |
     |   |   +--.[Just 3]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 1]
     |
     |
     +--.[Just 3]
     |   |
     |   |
     |   +--.[Just 1]
     |   |   |
     |   |   |
     |   |   +--.[Just 2]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 4]
     |   |   |
     |   |   |
     |   |   +--.[Just 4]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 2]
     |   |
     |   |
     |   +--.[Just 2]
     |   |   |
     |   |   |
     |   |   +--.[Just 1]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 4]
     |   |   |
     |   |   |
     |   |   +--.[Just 4]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 1]
     |   |
     |   |
     |   +--.[Just 4]
     |   |   |
     |   |   |
     |   |   +--.[Just 1]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 2]
     |   |   |
     |   |   |
     |   |   +--.[Just 2]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 1]
     |
     |
     +--.[Just 4]
     |   |
     |   |
     |   +--.[Just 1]
     |   |   |
     |   |   |
     |   |   +--.[Just 2]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 3]
     |   |   |
     |   |   |
     |   |   +--.[Just 3]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 2]
     |   |
     |   |
     |   +--.[Just 2]
     |   |   |
     |   |   |
     |   |   +--.[Just 1]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 3]
     |   |   |
     |   |   |
     |   |   +--.[Just 3]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 1]
     |   |
     |   |
     |   +--.[Just 3]
     |   |   |
     |   |   |
     |   |   +--.[Just 1]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 2]
     |   |   |
     |   |   |
     |   |   +--.[Just 2]
     |   |   |   |
     |   |   |   |
     |   |   |   +--.[Just 1]


]



 ...
 
 
 
--}